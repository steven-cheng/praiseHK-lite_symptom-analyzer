(this["webpackJsonphk.ust.ienv.praisehk_lite_symptom_analyzer"]=this["webpackJsonphk.ust.ienv.praisehk_lite_symptom_analyzer"]||[]).push([[0],{113:function(e,t,a){e.exports=a.p+"static/media/logo.fd291ecb.svg"},114:function(e,t,a){e.exports=a.p+"static/media/plus.dd88e7d2.svg"},124:function(e,t,a){e.exports=a.p+"static/media/save.aaa4672f.svg"},150:function(e,t,a){e.exports=a(170)},155:function(e,t,a){},156:function(e,t,a){},157:function(e,t,a){e.exports=a.p+"static/media/more.0d0660ce.svg"},167:function(e,t,a){},168:function(e,t,a){},170:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(15),l=a.n(o),i=a(65),c=(a(155),a(11)),s=a(17),m=a(222),u=a(113),d=a.n(u),p=a(220),y=a(223),E=a(224),f=a(125),b=a.n(f),v=a(127),g=a.n(v),h=a(126),O=a.n(h),S=(a(156),a(39)),j=a(69),w=a(94),N=a(116),C=a.n(N),x=a(38),_=a(59),k=a(114),M=a.n(k),I=a(172),A=a(229),P=a(233),R=a(213),T=a(210),D=a(211),H=a(212),L=a(203),B=a(207),F=a(208),U=a(232),Q=(a(157),a(115)),W=a.n(Q),q=a(209),K=a(237);function z(e){var t=Object(n.useState)(1),a=Object(c.a)(t,2),o=(a[0],a[1],Object(n.useState)(!1)),l=Object(c.a)(o,2),i=l[0],s=l[1];function m(){s(!1)}return r.a.createElement(r.a.Fragment,null,r.a.createElement(L.a,{style:{marginTop:"10px",marginBottom:"10px"},raised:!0},r.a.createElement(B.a,null,r.a.createElement("div",{style:{display:"inline-block",float:"left"}},e.name,"\xa0\xa0 \u2507 \xa0\xa0",r.a.createElement(F.a,{control:r.a.createElement(U.a,{checked:e.isNull,onChange:function(t){e.onisNullChange(e.tempID,t.target.checked)},name:"checkedB",color:"primary"}),label:"No input"})),r.a.createElement("div",{style:{display:"inline-block",float:"right"}},r.a.createElement(W.a,{onClick:function(){s(!0)},style:{fontSize:30,cursor:"pointer"}})),r.a.createElement("div",{style:{display:e.isNull?"none":"block"}},r.a.createElement(q.a,{container:!0,spacing:2,alignItems:"center",style:{marginTop:"5px",clear:"both"}},r.a.createElement(q.a,{item:!0,xs:!0},r.a.createElement(K.a,{value:e.severity,onChange:function(t,a){e.onSeverityChange(e.tempID,a)},step:1,min:1,max:5})),r.a.createElement(q.a,{item:!0,style:{minWidth:"2ch"}},e.severity))))),r.a.createElement("br",null),r.a.createElement(P.a,{open:i,onClose:m},r.a.createElement(T.a,null,r.a.createElement(D.a,null,"Are you sure? All the records of this symptom will be deleted and non-recoverable!")),r.a.createElement(H.a,null,r.a.createElement(I.a,{onClick:function(){e.deleteSymptomType(e.name),m()},color:"primary"},"Sure"),r.a.createElement(I.a,{onClick:m,color:"primary",autoFocus:!0},"Cancel"))))}var G={apikey:"zYqwCLD6iz3j"},V={apikey:"kSRkxMvG3ZIe"};function X(e){var t=Object(n.useRef)();return Object(n.useEffect)((function(){t.current=e})),t.current}var J=a(117),Y=a.n(J),Z=a(74),$=a(214),ee=a(132),te=a(215),ae=a(34),ne={display:"flex",justifyContent:"space-between",alignItems:"center"},re={flex:"none",marginLeft:10};function oe(e){var t=Object(n.useState)({indoor:!1,windowOpened:!1,airPurifierOn:!1,airConditionerOn:!1}),a=Object(c.a)(t,2),o=a[0],l=a[1],i=function(e){"indoor"!==e||o.indoor?"outdoor"===e&&o.indoor&&l({indoor:!1,windowOpened:!1,airPurifierOn:!1,airConditionerOn:!1}):l({indoor:!0,windowOpened:!1,airPurifierOn:!1,airConditionerOn:!1})},s=function(e){l(Object(S.a)(Object(S.a)({},o),{},Object(Z.a)({},e.target.name,e.target.checked)))};Object(n.useEffect)((function(){e.isOpen&&l({indoor:e.microEnvState.indoor,windowOpened:e.microEnvState.windowOpened,airPurifierOn:e.microEnvState.airPurifierOn,airConditionerOn:e.microEnvState.airConditionerOn})}),[e.isOpen]);var m=Object(ae.a)();return r.a.createElement(P.a,{open:e.isOpen,onClose:e.close},r.a.createElement(R.a,{style:{color:m.palette.primary.main}},"Micro Environment"),r.a.createElement(T.a,null,r.a.createElement(ee.a,{elevation:3,style:{minWidth:300,paddingTop:10,paddingBottom:10}},r.a.createElement("div",{style:Object(S.a)(Object(S.a)({},ne),{},{justifyContent:"center"})},r.a.createElement("div",{style:{flex:"none"}},r.a.createElement($.a,{color:"primary"},r.a.createElement(I.a,{variant:o.indoor?"contained":"outlined",onClick:function(){i("indoor")}},"Indoor"),r.a.createElement(I.a,{variant:o.indoor?"outlined":"contained",onClick:function(){i("outdoor")}},"Outdoor")))),r.a.createElement("div",{style:{display:o.indoor?"block":"none"}},r.a.createElement("div",{style:ne},r.a.createElement("p",{style:re},"Open Window"),r.a.createElement("div",{style:{flex:"none"}},r.a.createElement(te.a,{disabled:!o.indoor,checked:o.windowOpened,onChange:s,name:"windowOpened",color:"primary"}))),r.a.createElement("div",{style:ne},r.a.createElement("p",{style:re},"Air Purifier"),r.a.createElement("div",{style:{flex:"none"}},r.a.createElement(te.a,{disabled:!o.indoor,checked:o.airPurifierOn,onChange:s,name:"airPurifierOn",color:"primary"}))),r.a.createElement("div",{style:ne},r.a.createElement("p",{style:re},"Air-conditioner"),r.a.createElement("div",{style:{flex:"none"}},r.a.createElement(te.a,{disabled:!o.indoor,checked:o.airConditionerOn,onChange:s,name:"airConditionerOn",color:"primary"})))))),r.a.createElement(H.a,null,r.a.createElement(I.a,{onClick:function(){e.setMicroEnvState(o),e.close()},color:"primary"},"Confirm"),r.a.createElement(I.a,{onClick:e.close,color:"primary"},"Cancel")))}function le(e){var t,a=Object(n.useState)({path:null,state:null}),o=Object(c.a)(a,2),l=o[0],i=o[1],m=Object(n.useState)(!1),u=Object(c.a)(m,2),d=u[0],p=u[1],y=Object(n.useState)({hoisted:!1,error:null}),E=Object(c.a)(y,2),f=E[0],b=E[1],v=Object(n.useState)(!1),g=Object(c.a)(v,2),h=g[0],O=g[1],N=Object(n.useState)([]),k=Object(c.a)(N,2),L=k[0],B=k[1],F=X(L),U=Object(n.useState)(""),Q=Object(c.a)(U,2),W=Q[0],q=Q[1],K=Object(n.useState)(!1),J=Object(c.a)(K,2),Z=J[0],$=J[1],ee=Object(n.useState)(ve()),te=Object(c.a)(ee,2),ae=te[0],ne=te[1],re=X(e.saveNewSymptoms),le=Object(n.useState)(null),ie=Object(c.a)(le,2),ce=ie[0],se=ie[1],me=Object(n.useState)(!0),ue=Object(c.a)(me,2),de=ue[0],pe=ue[1],ye=Object(n.useRef)({indoor:!1,windowOpened:!1,airPurifierOn:!1,airConditionerOn:!1}),Ee=Object(n.useContext)(De),fe=Object(n.useContext)(Te).loader,be=Object(n.useContext)(Te).errorDialog;function ve(){return Object(x.a)(new Date,"dd MMMM yyyy  HH:mm")}function ge(){f.hoisted&&b({hoisted:!1,error:null}),p(!1),q("")}function he(){O(!1),e.saveNewSymptoms&&e.setSaveNewSymptoms(!1)}function Oe(e,t){B(L.map((function(a){return a.tempID===e&&(a.isNull=t),a})))}function Se(e,t){B(L.map((function(a){return a.tempID===e&&(a.severity=t),a})))}Object(n.useEffect)((function(){for(var t=[],a=function(a){var n=e.symptomTypes[a],r={tempID:"temp_"+n,typeName:n,isNull:!0,severity:1};F&&F.every((function(e){return e.typeName!==n||(r=e,!1)})),t.push(r)},n=0;n<e.symptomTypes.length;n++)a(n);B(t)}),[e.symptomTypes]),Object(n.useEffect)((function(){e.saveNewSymptoms&&(e.saveNewSymptoms&&0===L.length?e.setSaveNewSymptoms(!1):e.saveNewSymptoms&&!re&&L.length>0&&O(!0))}),[e.saveNewSymptoms]),Object(n.useEffect)((function(){if(Z)if(L.length>0){fe.loaderSwitch("on");var t,a,n,r,o=[],l=[],s=!1,m={lng:null,lat:null},u=new Date,d=Object(x.a)(u,"yyyy-MM-dd HH:mm"),p=u.toISOString();(y={maximumAge:1e4,timeout:2e4,enableHighAccuracy:!0},new Promise((function(e,t){window.navigator.geolocation.getCurrentPosition(e,t,y)}))).then((function(e){m.lng=e.coords.longitude,m.lat=e.coords.latitude;var t=new URL("https://praise-web.ust.hk/uwsgi/praise-service/"),a=Object(S.a)({todo:"get_data",lng:m.lng.toString(),lat:m.lat.toString(),t0:p,t1:p,pids:"PM10,PM2.5,NO2,O3,SO2,AQHIBN,AQHIER"},G);t.search=new URLSearchParams(a).toString();var n=new URL("https://praise-web.ust.hk/uwsgi/praise-ir-cal/"),r=ye.current,o={IO:r.indoor?"Other Indoor":"Outdoor"};r.indoor&&(o=Object(S.a)(Object(S.a)({},o),{},{MicEnv:[{Factor:"Window",Option:r.windowOpened?"OPEN":"CLOSE"},{Factor:"Air Conditioner",Option:r.airConditionerOn?"ON":"OFF"},{Factor:"Air Purifier",Option:r.airPurifierOn?"ON":"OFF"}]}));var l=Object(S.a)({todo:"ir_cal",input_env:JSON.stringify(o)},V);return n.search=new URLSearchParams(l).toString(),Promise.all([fetch(t).then((function(e){return e.json()})),fetch(n,{referrerPolicy:"origin"}).then((function(e){return e.json()}))])}),(function(e){be.setErrorMsg(null,"Unable to get the position"),console.log("cannot get position"),s=!0})).then((function(e){var a=Object(c.a)(e,2),n=a[0],r=a[1];return new Promise((function(e,a){if(0===n.status&&0===r.status){var i={AQHI:n.AQHIBN[0],pctAR:null,NO2_con:r.NO2_IR*n.NO2[0],SO2_con:r.SO2_IR*n.SO2[0],O3_con:r.O3_IR*n.O3[0],PM2dot5_con:r["PM2.5_IR"]*n["PM2.5"][0],PM10_con:r.PM10_IR*n.PM10[0]},c={NO2:.0004462559,SO2:.0001393235,O3:.0005116328,PM2dot5:.0002180567,PM10:.0002821751},s=100*(Math.exp(c.PM10*i.PM10_con)-1),u=100*(Math.exp(c.PM2dot5*i.PM2dot5_con)-1),p=s>u?s:u;i.pctAR=100*(Math.exp(c.NO2*i.NO2_con)-1)+100*(Math.exp(c.SO2*i.SO2_con)-1)+100*(Math.exp(c.O3*i.O3_con)-1)+p;var y=Ee.transaction(["symptoms_pollutants_relation"],"readwrite");y.onerror=function(e){a("Error : Unable to insert new symptoms into the DB")},y.oncomplete=function(t){e("All new symptoms are inserted into DB")};var E=y.objectStore("symptoms_pollutants_relation");t={AQHI:i.AQHI,pctAR:i.pctAR,NO2:i.NO2_con,SO2:i.SO2_con,O3:i.O3_con,PM2dot5:i.PM2dot5_con,PM10:i.PM10_con},L.forEach((function(e){if(!e.isNull){var a={datetime:d,coordinates:m,typeName:e.typeName,severity:e.severity,pollutantsValue:t};E.add(a).onsuccess=function(t){e.id=t.target.result,e.datetime=d,o.push(e.typeName),l.push(e.severity)}}}))}else a("Error in the pollutant info: Downloaded data_con not valid")}))}),(function(e){be.setErrorMsg(null,"Error in downloading pollutant info: "+e),console.log("Error in downloading pollutant info: ",e),s=!0})).then((function(e){var t=Ee.transaction("symptoms_pollutants_relation").objectStore("symptoms_pollutants_relation").index("typeName"),a=o.map((function(e){var a=t.count(e);return new Promise((function(e,t){a.onsuccess=function(){e(a.result)},a.onerror=function(){t()}}))}));return Promise.all(a)}),(function(e){be.setErrorMsg(null,e),console.log(e),s=!0})).then((function(e){return new Promise((function(t,r){var i=e.indexOf(Math.max.apply(Math,Object(j.a)(e)));a=o[i],n=l[i];var c=Ee.transaction("symptoms_pollutants_relation").objectStore("symptoms_pollutants_relation").index("typeName,datetime,severity"),s=IDBKeyRange.bound([a,"2000-01-01 00:00",Number.MIN_SAFE_INTEGER],[a,"9999-12-31 00:00",Number.MAX_SAFE_INTEGER]),m=c.openCursor(s);m.onsuccess=function(e){var a=e.target.result;a&&t(a.value.datetime)},m.onerror=function(){r()}}))}),(function(){console.log("Counting of the no. of the types in the database failed"),be.setErrorMsg(null,"Database counting operation failed"),s=!0})).then((function(e){r=Object(_.a)(e,"yyyy-MM-dd HH:mm",new Date)}),(function(){console.log("Starting date retrieval in the database failed"),be.setErrorMsg(null,'Database "starting date retrieval" operation failed'),s=!0})).finally((function(){fe.loaderSwitch("off"),$(!1),e.setSaveNewSymptoms(!1),s||i({path:"/chart",state:{symptom:a,highlightSymptom:!0,highlightedSymptomCurrentSeverity:n,highlightedSymptomCurrentPollutantsValue:t,dateRange:{start:r,end:new Date}}})}))}else e.setSaveNewSymptoms(!1);var y}),[Z]),Object(n.useEffect)((function(){var e=setInterval((function(){ne(ve())}),3e4);return function(){clearInterval(e)}}),[]),Object(n.useEffect)((function(){F&&0!==F.length&&F.length<L.length&&window.scrollBy(0,document.body.scrollHeight)}),[L]),Object(n.useEffect)((function(){if(ce){var t=Ee.transaction(["symptoms_pollutants_relation"],"readwrite"),a=t.objectStore("symptoms_pollutants_relation"),n=a.index("typeName").openKeyCursor(IDBKeyRange.only(ce));n.onsuccess=function(){var e=n.result;e&&(a.delete(e.primaryKey),e.continue())},t.oncomplete=function(){var t=Ee.transaction(["symptom_types"],"readwrite").objectStore("symptom_types"),a=t.index("symptom_type_name").openKeyCursor(IDBKeyRange.only(ce));a.onsuccess=function(){var n=a.result;n?(t.delete(n.primaryKey),n.continue()):e.setSymptomTypes(e.symptomTypes.filter((function(e){return e!==ce})))},a.onerror=function(){console.log('Error occurred when deleting symptom type records in "symptom_types"')}},t.onerror=function(){console.log('Error occurred when deleting symptom records in "symptoms_pollutants_relation"')},se(null)}}),[ce]),Object(n.useEffect)((function(){t&&!e.isSaveButtonDisabled&&e.setIsSaveButtonDisabled(!0),!t&&e.isSaveButtonDisabled&&e.setIsSaveButtonDisabled(!1)})),t=!0;var je=L.map((function(e){return!e.isNull&&t&&(t=!1),r.a.createElement(z,{key:e.tempID,tempID:e.tempID,name:e.typeName,isNull:e.isNull,onisNullChange:Oe,severity:e.severity?e.severity:null,onSeverityChange:Se,deleteSymptomType:se})}));return l.path?r.a.createElement(s.a,{to:{pathname:l.path,state:l.state?l.state:null}}):r.a.createElement("div",{className:"page"},r.a.createElement("p",{style:{marginTop:"20px"}},r.a.createElement(C.a,{color:"primary",style:{verticalAlign:"text-bottom"}})," \xa0 ",ae,"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0",r.a.createElement("span",{onClick:function(){pe(!0)},style:{cursor:"pointer"}},r.a.createElement(Y.a,{color:"primary",style:{verticalAlign:"text-bottom"}})," \xa0 Attributes")),r.a.createElement("p",{style:{textAlign:"center"}},"Mong Kok, Kowloon"),r.a.createElement("div",{style:{paddingTop:5}},je,r.a.createElement("br",null),r.a.createElement("div",{id:"addNewSymptom_div",onClick:function(){p(!0)},style:{marginBottom:100,cursor:"pointer"}},r.a.createElement("img",{src:M.a,width:24,height:24,style:{verticalAlign:"text-bottom"}})," \xa0\xa0",r.a.createElement(w.a,{variant:"h6",style:{display:"inline-block"}},"Add New Symptom"))),r.a.createElement(P.a,{open:d,onClose:ge},r.a.createElement(R.a,{style:{textAlign:"center"}},"Add Symptom"),r.a.createElement(T.a,null,r.a.createElement(A.a,{label:"New Symptom Name",margin:"normal",variant:"outlined",value:W,onChange:function(e){q(e.target.value)},error:f.hoisted,helperText:f.hoisted?f.error:"",style:{minWidth:"24ch"}})),r.a.createElement(H.a,null,r.a.createElement(I.a,{onClick:ge,color:"primary"},"Cancel"),r.a.createElement(I.a,{onClick:function(){var t=W.trim();if(""!==t){var a=Ee.transaction(["symptom_types"],"readwrite").objectStore("symptom_types").add({name:t});a.onsuccess=function(a){e.setSymptomTypes([].concat(Object(j.a)(e.symptomTypes),[t])),ge()},a.onerror=function(e){"ConstraintError"===e.target.error.name?(console.log("Error : The symptom name is already existed"),b({hoisted:!0,error:"The symptom name is already existed"})):console.log("Database Error : Unable to add symptom type.")}}else b({hoisted:!0,error:"Name cannot be empty"})},color:"primary"},"Add"))),r.a.createElement(P.a,{open:h,onClose:he},r.a.createElement(T.a,null,r.a.createElement(D.a,null,"Are you sure? Once saved, you are now allowed to edit or remove it.")),r.a.createElement(H.a,null,r.a.createElement(I.a,{onClick:function(){he(),$(!0)},color:"primary"},"Confirm"),r.a.createElement(I.a,{onClick:he,color:"primary",autoFocus:!0},"Cancel"))),r.a.createElement(oe,{isOpen:de,close:function(){pe(!1)},microEnvState:ye.current,setMicroEnvState:function(e){ye.current=e}}))}var ie=a(218);function ce(){return r.a.createElement("div",{className:"page"},r.a.createElement(w.a,{variant:"h6",color:"primary"},"Settings"),r.a.createElement("br",null),r.a.createElement("div",{style:{textAlign:"left"}},r.a.createElement(w.a,{variant:"h5",color:"primary"},"PUSH NOTIFICATION"),r.a.createElement(ie.a,null),r.a.createElement("br",null),r.a.createElement(w.a,{variant:"body1"},r.a.createElement("span",{style:{verticalAlign:"sub"}},"Receive input reminder"),r.a.createElement(F.a,{control:r.a.createElement(te.a,{color:"primary"}),style:{float:"right"}})),r.a.createElement("br",null),r.a.createElement(ie.a,null)),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("div",{style:{textAlign:"left"}},r.a.createElement(w.a,{variant:"h5",color:"primary"},"EXPORT"),r.a.createElement(ie.a,null),r.a.createElement("br",null),r.a.createElement(w.a,{variant:"body1"},r.a.createElement("span",{style:{verticalAlign:"sub"}},"Export correlation chart as image")),r.a.createElement("br",null),r.a.createElement(ie.a,null),r.a.createElement("br",null),r.a.createElement(w.a,{variant:"body1"},r.a.createElement("span",{style:{verticalAlign:"sub"}},"Export data as csv")),r.a.createElement("br",null),r.a.createElement(ie.a,null)))}var se=a(101),me=a.n(se),ue=a(118),de=a(219),pe=a(120),ye=a.n(pe),Ee=a(228),fe=a(236),be=a(226),ve=a(119),ge=a.n(ve),he=a(102),Oe=a.n(he);a(167);function Se(e){var t=Object(n.useContext)(De),a=Object(n.useContext)(Te).errorDialog,o=Object(n.useState)({path:null}),l=Object(c.a)(o,2),i=l[0],m=l[1],u=Object(n.useState)((function(){return e.location.state&&e.location.state.symptom?e.location.state.symptom:null})),d=Object(c.a)(u,2),y=d[0],E=d[1],f=X(y),b=Object(n.useState)((function(){return e.location.state&&e.location.state.highlightSymptom?{currentSeverity:e.location.state.highlightedSymptomCurrentSeverity,currentPollutantsValue:e.location.state.highlightedSymptomCurrentPollutantsValue}:null})),v=Object(c.a)(b,2),g=v[0],h=v[1],O=Object(n.useState)((function(){return e.location.state&&e.location.state.dateRange?{start:e.location.state.dateRange.start,end:e.location.state.dateRange.end}:{start:null,end:new Date}})),S=Object(c.a)(O,2),N=S[0],C=S[1],k=X(N),M=Object(n.useState)(null),D=Object(c.a)(M,2),L=D[0],B=D[1],F=Object(n.useState)("AQHI"),U=Object(c.a)(F,2),Q=U[0],W=U[1],q=Object(n.useState)(N.start),K=Object(c.a)(q,2),z=K[0],G=K[1],V=Object(n.useState)(!1),J=Object(c.a)(V,2),Y=J[0],Z=J[1],ee=Object(n.useState)((function(){return y&&N.start?"mounting:started":null})),te=Object(c.a)(ee,2),ae=te[0],ne=te[1],re=Object(n.useRef)(null),oe=function(){L&&B(null),Z(!1)},le=function(e){W(e)};return Object(n.useEffect)((function(){y||N.start||Object(ue.a)(me.a.mark((function n(){var r,o,l,i,c,s,m,u;return me.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.transaction("symptoms_pollutants_relation").objectStore("symptoms_pollutants_relation"),o=r.index("typeName"),n.prev=2,n.next=5,Promise.all(e.symptomTypes.map((function(e){var t=o.count(e);return new Promise((function(e,a){t.onsuccess=function(){e(t.result)},t.onerror=function(){a()}}))})));case 5:return l=n.sent,i=l.indexOf(Math.max.apply(Math,Object(j.a)(l))),c=e.symptomTypes[i],s=r.index("typeName,datetime,severity"),n.next=11,new Promise((function(e,t){var a=IDBKeyRange.bound([c,"2000-01-01 00:00",Number.MIN_SAFE_INTEGER],[c,"9999-12-31 00:00",Number.MAX_SAFE_INTEGER]),n=s.openCursor(a);n.onsuccess=function(t){var a=t.target.result;a&&e(a.value.datetime)},n.onerror=function(){t()}}));case 11:m=n.sent,u=Object(_.a)(m,"yyyy-MM-dd HH:mm",new Date),E(c),C({start:u,end:N.end}),n.next=21;break;case 17:n.prev=17,n.t0=n.catch(2),console.log("Starting date retrieval in the database failed"),a.setErrorMsg(null,'Database "starting date retrieval" operation failed');case 21:case"end":return n.stop()}}),n,null,[[2,17]])})))()}),[y,N]),Object(n.useEffect)((function(){y&&N.start&&"mounting:started"!==ae&&(ne("mounting:started"),y===f&&N.start===k.start&&N.end===k.end||h(null))}),[y,N,Q]),Object(n.useEffect)((function(){if(y&&N.start)if("mounting:started"!==ae){if("mounting:dismounted"===ae){for(var e=t.transaction("symptoms_pollutants_relation").objectStore("symptoms_pollutants_relation").index("typeName,datetime,severity"),a=IDBKeyRange.bound([y,N.start?Object(x.a)(N.start,"yyyy-MM-dd HH:mm"):"2000-01-01 00:00",Number.MIN_SAFE_INTEGER],[y,Object(x.a)(N.end,"yyyy-MM-dd HH:mm"),Number.MAX_SAFE_INTEGER]),n=e.openCursor(a),r=new Array(5),o={AQHI:1,pctAR:1,O3:10,NO2:10,SO2:1,PM10:2,PM2dot5:1},l=0;l<r.length;l++){r[l]=new Array(11);for(var i=0;i<11;i++)r[l][i]=0}n.onsuccess=function(e){var t=e.target.result;if(t){var a=t.value.severity-1,n=Math.floor(t.value.pollutantsValue[Q]/o[Q]);r[a][n]++,t.continue()}else{var l,i;g&&(i={i:g.currentSeverity-1,j:Math.floor(g.currentPollutantsValue[Q]/o[Q])});for(var c=[],s=0;s<r.length;s++)for(var u=0;u<11;u++){var d=s+1,p=void 0;p="AQHI"===Q?u*o[Q]:(u+.5)*o[Q];var y=r[s][u];c.push({x:d,y:p,r:y}),i&&i.i===s&&i.j===u&&(l=[{x:d,y:p,r:y+6}])}var E,f={AQHI:"rgba(112,193,180,1)",pctAR:"rgba(255,224,102,1)",O3:"rgba(242,204,195,1)",NO2:"rgba(171,163,210,1)",SO2:"rgba(229,151,198,1)",PM10:"rgba(168,237,255,1)",PM2dot5:"rgba(168,237,255,1)"},b={};switch(Q){case"AQHI":E="AQHI",b={min:1,callback:function(e){return 11===parseInt(e)?e+"+":e}};break;case"pctAR":E="%AR";break;default:E="concentration (\u03bcgm\xb3)"}var v=[{data:c,backgroundColor:f[Q]}];0!==c.length&&v.push({data:l,backgroundColor:f[Q].replace(",1)",",0.5)")}),new ge.a(re.current,{type:"bubble",data:{datasets:v},options:{events:["click"],onClick:function(e,t){t.length>0&&m({path:"/chartPoint_details"})},datasets:{bubble:{hoverRadius:0,hitRadius:10}},tooltips:{enabled:!1},legend:{display:!1},scales:{xAxes:[{scaleLabel:{display:!0,labelString:"seriousness"}}],yAxes:[{scaleLabel:{display:!0,labelString:E},ticks:b}]}}})}},n.onerror=function(){console.log("error")},ne("mounting:mounted")}}else ne("mounting:dismounted")}),[ae]),Object(n.useEffect)((function(){Oe()(window).scrollTop()>0&&Oe()(window).scrollTop(0)}),[]),i.path?r.a.createElement(s.a,{to:{pathname:i.path}}):y&&N.start?r.a.createElement("div",{className:"page"},r.a.createElement("div",{style:{textAlign:"center",marginTop:"15px"}},r.a.createElement(A.a,{value:(N.start?Object(x.a)(N.start,"ddMMM"):"      ")+" - "+Object(x.a)(N.end,"ddMMM"),InputProps:{endAdornment:r.a.createElement(de.a,{position:"end"},r.a.createElement(ye.a,null))},variant:"outlined",style:{width:"17ch"},onClick:function(e){Z(!0)}}),"\xa0\xa0\xa0\xa0",r.a.createElement(Ee.a,{value:y,onChange:function(e){E(e.target.value)},variant:"outlined",style:{width:"10em"}},e.symptomTypes.map((function(e){return r.a.createElement(fe.a,{key:e,value:e},e)})))),r.a.createElement(p.a,{style:{marginTop:"15px"}},r.a.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"}},r.a.createElement("div",{style:{flex:"none"}},"mounting:started"===ae?r.a.createElement("div",{style:{width:300,height:400,maxWidth:300,maxHeight:400,marginRight:20}}):r.a.createElement("canvas",{ref:re,style:{width:300,height:400,maxWidth:300,maxHeight:400,marginRight:20}})),r.a.createElement($.a,{style:{flex:"none"},orientation:"vertical",color:"primary",size:"small"},r.a.createElement(I.a,{onClick:function(){le("AQHI")},variant:"AQHI"===Q?"contained":"outlined"},"AQHI"),r.a.createElement(I.a,{onClick:function(){le("pctAR")},variant:"pctAR"===Q?"contained":"outlined"},"%AR"),r.a.createElement(I.a,{onClick:function(){le("O3")},variant:"O3"===Q?"contained":"outlined"},"O",r.a.createElement("span",{className:"sub"},"3")),r.a.createElement(I.a,{onClick:function(){le("NO2")},variant:"NO2"===Q?"contained":"outlined"},"NO",r.a.createElement("span",{className:"sub"},"2")),r.a.createElement(I.a,{onClick:function(){le("SO2")},variant:"SO2"===Q?"contained":"outlined"},"SO",r.a.createElement("span",{className:"sub"},"2")),r.a.createElement(I.a,{onClick:function(){le("PM10")},variant:"PM10"===Q?"contained":"outlined"},"PM",r.a.createElement("span",{className:"sub"},"10")),r.a.createElement(I.a,{onClick:function(){le("PM2dot5")},variant:"PM2dot5"===Q?"contained":"outlined"},"PM",r.a.createElement("span",{className:"sub"},"2.5")))),r.a.createElement("p",null,"Entry: ",y),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(w.a,{variant:"h6"},"Health Advisory"),r.a.createElement(w.a,{variant:"body1",style:{textAlign:"left"}},"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.")),r.a.createElement(P.a,{open:Y,onEnter:function(){G(N.start)},onClose:oe},r.a.createElement(R.a,null,L?"To":"From"),r.a.createElement(T.a,null,r.a.createElement(be.a,{autoOk:!0,orientation:"landscape",variant:"static",disableToolbar:!0,minDate:L||null,disableFuture:!0,openTo:"date",value:z,onChange:G})),r.a.createElement(H.a,null,r.a.createElement(I.a,{onClick:oe,color:"primary"},"Cancel"),r.a.createElement(I.a,{onClick:function(){L?(C({start:L,end:z}),oe()):(B(z),L>N.end?G(L):G(N.end))},color:"primary"},L?"Done":"Next")))):r.a.createElement(r.a.Fragment,null)}a(168);var je=a(121),we=a.n(je),Ne=a(122),Ce=a.n(Ne),xe=a(123),_e=a.n(xe);function ke(e){var t=Object(ae.a)(),a={color:t.palette.primary.main};return r.a.createElement("div",{className:"page"},r.a.createElement("div",null,r.a.createElement(w.a,{variant:"h5",gutterBottom:!0,style:{textAlign:"left",color:t.palette.primary.main,fontWeight:"bold"}},"DETAILS"),r.a.createElement(L.a,{className:"card",raised:!0,elevation:10},r.a.createElement(B.a,null,r.a.createElement("div",{className:"card-content-div"},r.a.createElement("div",{className:"icon-row"},r.a.createElement(we.a,null)),r.a.createElement(w.a,{className:"typography-p",variant:"body2",component:"p"},r.a.createElement("span",{style:a},"Date & Time :")," 4 Jun 2020 18:00"),r.a.createElement(w.a,{className:"typography-p",variant:"body2",component:"p"},r.a.createElement("span",{style:a},"Location :")," Nathan Road"),r.a.createElement(w.a,{className:"typography-p",variant:"body2",component:"p"},r.a.createElement("span",{style:a},"Conc. of PM",r.a.createElement("sub",null,"10")," :")," 65 ug/m"),r.a.createElement(w.a,{className:"typography-p",variant:"body2",component:"p"},r.a.createElement("span",{style:a},"Seriousness :")," 4")))),r.a.createElement("br",null),r.a.createElement(L.a,{className:"card",raised:!0,elevation:10},r.a.createElement(B.a,null,r.a.createElement("div",{className:"card-content-div"},r.a.createElement("div",{className:"icon-row"},r.a.createElement(Ce.a,null)," ",r.a.createElement(_e.a,null)),r.a.createElement(w.a,{className:"typography-p",variant:"body2",component:"p"},r.a.createElement("span",{style:a},"Date & Time :")," 16 Jun 2020 12:30"),r.a.createElement(w.a,{className:"typography-p",variant:"body2",component:"p"},r.a.createElement("span",{style:a},"Location :")," Metro City"),r.a.createElement(w.a,{className:"typography-p",variant:"body2",component:"p"},r.a.createElement("span",{style:a},"Conc. of PM",r.a.createElement("sub",null,"10")," :")," 66.1 ug/m"),r.a.createElement(w.a,{className:"typography-p",variant:"body2",component:"p"},r.a.createElement("span",{style:a},"Seriousness :")," 3"))))))}var Me=a(124),Ie=a.n(Me),Ae=a(221),Pe=a(128),Re=a.n(Pe),Te=r.a.createContext({UILocker:{isUILockerOn:null,UILockerSwitch:null,UILockerRequireCount:null},loader:{isLoading:null,loaderSwitch:null,loaderRequireCount:null},errorDialog:{setErrorMsg:null}}),De=r.a.createContext(null);function He(){var e=Object(n.useRef)(0).current,t=Object(n.useRef)(0).current,a=Object(s.g)(),o=Object(n.useState)(!1),l=Object(c.a)(o,2),i=l[0],u=l[1],f=Object(n.useState)(!1),v=Object(c.a)(f,2),h=v[0],S=v[1],j=Object(n.useState)({isOpen:!1,title:null,contentText:null}),w=Object(c.a)(j,2),N=w[0],C=w[1],x=Object(n.useState)(null),_=Object(c.a)(x,2),k=_[0],M=_[1],I=Object(n.useState)([]),A=Object(c.a)(I,2),P=A[0],R=A[1],T=Object(n.useState)(!1),D=Object(c.a)(T,2),H=D[0],L=D[1],B=Object(n.useState)(!0),F=Object(c.a)(B,2),U=F[0],Q=F[1];Object(n.useEffect)((function(){var e=window.indexedDB.open("praiseHK-lite_symptom-analyzer_DB",1);e.onupgradeneeded=function(e){var t=e.target.result,a=t.createObjectStore("symptom_types",{keyPath:"id",autoIncrement:!0});a.createIndex("symptom_type_name","name",{unique:!0});var n=["Wheezing","Phlegm","Shortness of breath","Chest tightness","Itchy eyes","Redness of eyes"];a.transaction.oncomplete=function(e){var a=t.transaction("symptom_types","readwrite").objectStore("symptom_types");n.forEach((function(e){a.add({name:e})}))};var r=t.createObjectStore("symptoms_pollutants_relation",{keyPath:"id",autoIncrement:!0});r.createIndex("datetime","datetime",{unique:!1}),r.createIndex("typeName","typeName",{unique:!1}),r.createIndex("typeName,datetime,severity",["typeName","datetime","severity"],{unique:!1})},e.onsuccess=function(e){M(e.target.result)},e.onerror=function(e){console.log("Database initialization error")}}),[]),Object(n.useEffect)((function(){if(k){var e=k.transaction("symptom_types").objectStore("symptom_types").openCursor(),t=[];e.onsuccess=function(e){var a=e.target.result;a?(t.push(a.value.name),a.continue()):R(t)},e.onerror=function(){console.log("Error: failed to get symptom types from the database")}}}),[k]);var W,q=Object(s.h)().pathname;return"/"===q&&(q+="home"),"/android_asset/www/index.html"===q&&(q="/home"),W="/chartPoint_details"===q?"#e6efff":"initial",k?0===P.length?r.a.createElement(r.a.Fragment,null):r.a.createElement(r.a.Fragment,null,r.a.createElement(Le,{isLoading:h}),r.a.createElement(Be,{isLocked:i}),r.a.createElement(Fe,{state:N,setState:C}),r.a.createElement(De.Provider,{value:k},r.a.createElement(Te.Provider,{value:{UILocker:{isUILockerOn:i,UILockerSwitch:function(t){"on"===t?(0===e&&u(!0),e++):"off"===t&&0===--e&&u(!1)},UILockerRequireCount:e},loader:{isLoading:h,loaderSwitch:function(e){"on"===e?(0===t&&S(!0),t++):"off"===e&&0===--t&&S(!1)},loaderRequireCount:t},errorDialog:{setErrorMsg:function(e,t){C({isOpen:!0,title:e,contentText:t})}}}},r.a.createElement("div",{className:"App"},r.a.createElement(m.a,{color:"inherit",position:"sticky",style:{paddingTop:"10px",paddingBottom:"10px"}},r.a.createElement("div",null,r.a.createElement("img",{src:d.a,width:89,height:52}))),r.a.createElement(p.a,{maxWidth:"md",style:{paddingTop:"10px",height:"100%",backgroundColor:W}},r.a.createElement(s.d,null,r.a.createElement(s.b,{path:"/settings",component:ce}),r.a.createElement(s.b,{path:"/chart",render:function(e){return r.a.createElement(Se,Object.assign({},e,{symptomTypes:P}))}}),r.a.createElement(s.b,{path:"/chartPoint_details",component:ke}),r.a.createElement(s.b,{path:"/",render:function(e){return r.a.createElement(le,Object.assign({},e,{symptomTypes:P,setSymptomTypes:R,saveNewSymptoms:H,setSaveNewSymptoms:L,isSaveButtonDisabled:U,setIsSaveButtonDisabled:Q}))}}))),r.a.createElement(p.a,{maxWidth:!1,style:{position:"fixed",bottom:0,backgroundColor:"white"}},r.a.createElement(y.a,{value:q.substring(1),onChange:function(e,t){a.push("/"+t)},showLabels:!0,style:{marginLeft:"auto",marginRight:"auto",maxWidth:"500px"}},r.a.createElement(E.a,{value:"chart",icon:r.a.createElement(b.a,null)}),r.a.createElement(E.a,{value:"home",icon:r.a.createElement(O.a,null)}),r.a.createElement(E.a,{value:"settings",icon:r.a.createElement(g.a,null)})),"/home"===q&&r.a.createElement("img",{src:Ie.a,onClick:function(){U||L(!0)},style:{position:"absolute",bottom:"15px",left:"50%",WebkitTransform:"translateX(-50%)",transform:"translateX(-50%)",width:"64px",height:"64px",filter:U?"grayscale(75%)":"",cursor:"pointer"}})))))):r.a.createElement(r.a.Fragment,null)}function Le(e){return r.a.createElement("div",{className:"loader-modal-screen ".concat(e.isLoading?"loading":"not-loading")},r.a.createElement(Ae.a,{style:{color:"grey"},thickness:6}))}function Be(e){return r.a.createElement("div",{className:"UILocker-modal-screen ".concat(e.isLocked?"UI-locked":"UI-not-locked")})}function Fe(e){var t=e.state,a=t.isOpen,n=t.title,o=t.contentText;function l(){e.setState({isOpen:!1,title:null,contentText:null})}return r.a.createElement(P.a,{open:a,onClose:l},r.a.createElement(R.a,null,r.a.createElement(Re.a,{color:"secondary"})," ",n||"Error"),r.a.createElement(T.a,null,r.a.createElement(D.a,null,o)),r.a.createElement(H.a,null,r.a.createElement(I.a,{onClick:l,color:"primary",autoFocus:!0},"OK")))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(169);var Ue=a(23),Qe=a(129),We=a(227),qe=a(130),Ke=a(225);document.addEventListener("deviceready",(function(){var e=Object(qe.a)({palette:{primary:{main:"#0091CE"}}});l.a.render(r.a.createElement(We.b,{injectFirst:!0},r.a.createElement(i.a,{basename:"/~praise/praiseHK-lite_symptom-analyzer/dev"}," ",r.a.createElement(Ue.a,{utils:Qe.a},r.a.createElement(Ke.a,{theme:e},r.a.createElement(He,null))))),document.getElementById("root"))}),!1),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[150,1,2]]]);
//# sourceMappingURL=main.ff114253.chunk.js.map